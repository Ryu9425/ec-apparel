{#
販売期間設定プラグイン(JsysSalesPeriod)
フロント > 商品一覧
 - 販売前・終了後に表示する商品のカートボタンを置き換えるjsを追加
#}
<script>
  $(function() {
      let $before   = "{% apply escape('js') %}{{ include('@JsysSalesPeriod/default/Product/button_before_sale.twig', {'JsysSalesPeriodConfig': JsysSalesPeriodConfig}) }}{% endapply %}";
      let $finished = "{% apply escape('js') %}{{ include('@JsysSalesPeriod/default/Product/button_finished.twig', {'JsysSalesPeriodConfig': JsysSalesPeriodConfig}) }}{% endapply %}";

      {# 販売前 #}
      {% for Product in pagination if Product.isJsysSalesPeriodBeforeSale %}
          {% if Product.stock_find %}
              $('li.ec-shelfGrid__item a[href="{{ url('product_detail', {'id': Product.id}) }}"]')
                  .parent()
                  .find('div.ec-productRole__btn button[type="submit"].add-cart')
                  .replaceWith($before);
          {% else %}
              $('li.ec-shelfGrid__item a[href="{{ url('product_detail', {'id': Product.id}) }}"]')
                  .parent()
                  .find('div.ec-productRole__btn button[type="button"].ec-blockBtn--action:disabled')
                  .replaceWith($before);
          {% endif %}
      {% endfor %}

      {# 終了後 #}
      {% for Product in pagination if Product.isJsysSalesPeriodFinishedSale %}
          {% if Product.stock_find %}
              $('li.ec-shelfGrid__item a[href="{{ url('product_detail', {'id': Product.id}) }}"]')
                  .parent()
                  .find('div.ec-productRole__btn button[type="submit"].add-cart')
                  .replaceWith($finished);
          {% else %}
              $('li.ec-shelfGrid__item a[href="{{ url('product_detail', {'id': Product.id}) }}"]')
                  .parent()
                  .find('div.ec-productRole__btn button[type="button"].ec-blockBtn--action:disabled')
                  .replaceWith($finished);
          {% endif %}
      {% endfor %}
  });
</script>